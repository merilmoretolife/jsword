<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>docx.js Test</title>
</head>
<body>
  <h2>docx UMD Test</h2>
  <button onclick="generateDoc()">Download Word</button>

  <!-- ✅ UMD build -->
  <script src="https://cdn.jsdelivr.net/npm/docx@8.1.2/build/index.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

  <script>
    async function generateDoc() {
      const {
        Document,
        Packer,
        Paragraph,
        HeadingLevel,
        AlignmentType
      } = window.docx;

      const doc = new Document({
        sections: [{
          children: [
            new Paragraph({
              text: "Design Input – Sample Device",
              heading: HeadingLevel.TITLE,
              alignment: AlignmentType.CENTER
            }),
            new Paragraph({
              text: "Document Number: DI/ABC/001 Rev. 00",
              alignment: AlignmentType.RIGHT
            }),
            new Paragraph({
              text: "Date: " + new Date().toLocaleDateString(),
              alignment: AlignmentType.RIGHT
            }),
            new Paragraph({
              text: "1. Functional and Performance Requirements",
              heading: HeadingLevel.HEADING_2
            }),
            new Paragraph({
              text: "Device must function within defined operating parameters."
            }),
            new Paragraph({
              text: "2. Biological Safety Requirements",
              heading: HeadingLevel.HEADING_2
            }),
            new Paragraph({
              text: "Compliant with ISO 10993 and non-toxic."
            }),
            new Paragraph({
              text: "Meril Healthcare Pvt. Ltd. — Confidential",
              alignment: AlignmentType.CENTER
            })
          ]
        }]
      });

      const blob = await Packer.toBlob(doc);
      saveAs(blob, "Design_Input.docx");
    }
  </script>
</body>
</html>
