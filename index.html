<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Docx Export with docx.js</title>
  <script src="https://cdn.jsdelivr.net/npm/docx@8.4.0/build/index.umd.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/file-saver@2.0.5/dist/FileSaver.min.js"></script>
</head>
<body>
  <h1>Export to Word Test(docx.js)</h1>
  <button onclick="exportDocx()">Export DOCX</button>

  <script>
    async function exportDocx() {
      const { Document, Packer, Paragraph, TextRun, Header, Footer, PageBreak, AlignmentType } = docx;

      const line = new Paragraph({
        children: [new TextRun(" ")],
        border: {
          bottom: {
            color: "auto",
            space: 1,
            value: "single",
            size: 6,
          },
        },
      });

      const header = new Header({
        children: [
          new Paragraph({ text: "Test Export to Word", alignment: AlignmentType.CENTER }),
          line
        ]
      });

      const footer = new Footer({
        children: [
          line,
          new Paragraph({
            children: [
              new TextRun("Page "),
              new TextRun({ fieldType: "PAGE" })
            ],
            alignment: AlignmentType.CENTER,
          }),
        ]
      });

      const doc = new Document({
        sections: [
          {
            headers: { default: header },
            footers: { default: footer },
            children: [
              new Paragraph("This is page 1 content."),
              new Paragraph("More text on page 1."),
              new Paragraph({ children: [new TextRun("")], pageBreakAfter: true }),
              new Paragraph("This is page 2 content."),
              new Paragraph("More text on page 2."),
              new Paragraph({ children: [new TextRun("")], pageBreakAfter: true }),
              new Paragraph("This is page 3 content."),
              new Paragraph("More text on page 3.")
            ],
          }
        ],
      });

      const blob = await Packer.toBlob(doc);
      saveAs(blob, "exported.docx");
    }
  </script>
</body>
</html>
