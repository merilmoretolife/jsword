<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Docx Export with docx.js</title>
  <script src="https://cdn.jsdelivr.net/npm/docx@8.4.0/build/index.umd.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/file-saver@2.0.5/dist/FileSaver.min.js"></script>
</head>
<body>
  <h1>Export to Word 2(docx.js)</h1>
  <button onclick="exportDocx()">Export DOCX</button>

  <script>
    async function exportDocx() {
      const {
        Document,
        Packer,
        Paragraph,
        TextRun,
        Header,
        Footer,
        AlignmentType,
        PageBreak,
      } = docx;

      const divider = new Paragraph({
        children: [new TextRun("----------------")],
        alignment: AlignmentType.CENTER,
      });

      const header = new Header({
        children: [
          new Paragraph({ text: "Test Export to Word", alignment: AlignmentType.CENTER }),
          divider,
        ],
      });

      const footer = new Footer({
        children: [
          divider,
          new Paragraph({
            children: [
              new TextRun("Page "),
              new TextRun({ fieldType: "PAGE", children: [""] }),
            ],
            alignment: AlignmentType.CENTER,
          }),
        ],
      });

      const filler = (text) => new Array(40).fill(new Paragraph(text)).flat();

      const doc = new Document({
        sections: [
          {
            headers: { default: header },
            footers: { default: footer },
            children: [
              ...filler("This is page 1 content."),
              new Paragraph({ children: [new TextRun("")], pageBreakAfter: true }),
              ...filler("This is page 2 content."),
              new Paragraph({ children: [new TextRun("")], pageBreakAfter: true }),
              ...filler("This is page 3 content."),
            ],
          },
        ],
      });

      const blob = await Packer.toBlob(doc);
      saveAs(blob, "exported.docx");
    }
  </script>
</body>
</html>
